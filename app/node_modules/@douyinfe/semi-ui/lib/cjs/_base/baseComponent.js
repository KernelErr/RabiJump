"use strict";

var _Object$defineProperty = require("@babel/runtime-corejs3/core-js-stable/object/define-property");

var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");

_Object$defineProperty(exports, "__esModule", {
  value: true
});

exports.default = void 0;

var _assign = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/assign"));

var _react = require("react");

var _log = _interopRequireDefault(require("@douyinfe/semi-foundation/lib/cjs/utils/log"));

/**
 * The Semi Foundation / Adapter architecture split was inspired by Material Component For Web. ï¼ˆhttps://github.com/material-components/material-components-webï¼‰
 * We re-implemented our own code based on the principle and added more functions we need according to actual needs.
 */
const {
  hasOwnProperty
} = Object.prototype; // eslint-disable-next-line

class BaseComponent extends _react.Component {
  constructor(props) {
    super(props); // eslint-disable-next-line

    this.isControlled = key => Boolean(key && this.props && typeof this.props === 'object' && hasOwnProperty.call(this.props, key));

    this.cache = {};
    this.foundation = null;
  }

  componentDidMount() {
    this.foundation && typeof this.foundation.init === 'function' && this.foundation.init();
  }

  componentWillUnmount() {
    this.foundation && typeof this.foundation.destroy === 'function' && this.foundation.destroy();
    this.cache = {};
  }

  get adapter() {
    return {
      getContext: key => {
        if (this.context && key) {
          return this.context[key];
        }
      },
      getContexts: () => this.context,
      getProp: key => this.props[key],
      // return all props
      getProps: () => this.props,
      getState: key => this.state[key],
      getStates: () => this.state,
      setState: (states, cb) => this.setState((0, _assign.default)({}, states), cb),
      getCache: key => key && this.cache[key],
      getCaches: () => this.cache,
      setCache: (key, value) => key && (this.cache[key] = value),
      stopPropagation: e => {
        try {
          e.stopPropagation();
          e.nativeEvent && e.nativeEvent.stopImmediatePropagation();
        } catch (error) {}
      }
    };
  }

  log(text) {
    for (var _len = arguments.length, rest = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      rest[_key - 1] = arguments[_key];
    }

    return (0, _log.default)(text, ...rest);
  }

}

exports.default = BaseComponent;
BaseComponent.propTypes = {};
BaseComponent.defaultProps = {};