"use strict";

var _Object$defineProperty = require("@babel/runtime-corejs3/core-js-stable/object/define-property");

var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");

_Object$defineProperty(exports, "__esModule", {
  value: true
});

exports.default = void 0;

var _indexOf = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/index-of"));

var _getOwnPropertySymbols = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols"));

var _assign = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/assign"));

var _get2 = _interopRequireDefault(require("lodash/get"));

var _react = _interopRequireDefault(require("react"));

var _ConfirmModal = _interopRequireDefault(require("../ConfirmModal"));

var __rest = void 0 && (void 0).__rest || function (s, e) {
  var t = {};

  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && (0, _indexOf.default)(e).call(e, p) < 0) t[p] = s[p];

  if (s != null && typeof _getOwnPropertySymbols.default === "function") for (var i = 0, p = (0, _getOwnPropertySymbols.default)(s); i < p.length; i++) {
    if ((0, _indexOf.default)(e).call(e, p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];
  }
  return t;
};

// eslint-disable-next-line max-len
const HookModal = (_a, ref) => {
  var {
    afterClose,
    config
  } = _a,
      props = __rest(_a, ["afterClose", "config"]);

  const [innerConfig, setInnerConfig] = _react.default.useState(config);

  _react.default.useImperativeHandle(ref, () => ({
    destroy: () => {
      setInnerConfig(originConfig => (0, _assign.default)((0, _assign.default)({}, originConfig), {
        visible: false
      }));
    },
    update: newConfig => {
      setInnerConfig(originConfig => (0, _assign.default)((0, _assign.default)({}, originConfig), newConfig));
    }
  }));

  const {
    motion
  } = props;
  /* istanbul ignore next */

  const mergedMotion = typeof motion === 'undefined' || motion ? (0, _assign.default)((0, _assign.default)({}, motion), {
    didLeave: function () {
      const didLeave = (0, _get2.default)(props.motion, 'didLeave');

      if (typeof didLeave === 'function') {
        didLeave(...arguments);
      }

      afterClose();
    }
  }) : false;
  return /*#__PURE__*/_react.default.createElement(_ConfirmModal.default, (0, _assign.default)({}, innerConfig, {
    // visible={!visible ? visible : undefined}
    motion: mergedMotion
  }));
};

var _default = /*#__PURE__*/_react.default.forwardRef(HookModal);

exports.default = _default;